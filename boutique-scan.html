<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scan Code Retrait - E-Shop S√©curis√©</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <span class="cart-icon"><img style="height: 85px; width: 85px;" src="Img/LOGO (2).jpg" alt=""></span>
                <span>E-SHOP S√âCURIS√â - BOUTIQUE PHYSIQUE</span>
            </div>
            <nav class="nav">
                <a href="index.html" class="nav-link">BOUTIQUE</a>
                <a href="boutique-scan.html" class="nav-link active">SCAN CODE</a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <h1 class="page-title">Validation de Retrait</h1>

            <div class="scan-section">
                <div class="scan-box">
                    <h2>Scanner le Code de Retrait</h2>
                    
                    <!-- Onglets pour choisir le mode de scan -->
                    <div class="scan-tabs">
                        <button class="scan-tab active" data-tab="manual">Saisie manuelle</button>
                        <button class="scan-tab" data-tab="camera">Scanner QR Code</button>
                        <button class="scan-tab" data-tab="upload">Upload image</button>
                    </div>

                    <!-- Mode saisie manuelle -->
                    <div id="manual-scan" class="scan-mode active">
                        <div class="scan-input-group">
                            <input type="text" id="code-input" class="code-input" placeholder="Entrez le code de retrait" autofocus>
                            <button id="scan-btn" class="btn btn-primary">Valider</button>
                        </div>
                        <p class="scan-hint">Entrez le code re√ßu par le client</p>
                    </div>

                    <!-- Mode scan cam√©ra -->
                    <div id="camera-scan" class="scan-mode" style="display: none;">
                        <div id="qr-reader" style="width: 100%; max-width: 500px; margin: 0 auto;"></div>
                        <button id="stop-camera-btn" class="btn btn-secondary" style="display: none; margin-top: 15px;">Arr√™ter la cam√©ra</button>
                        <p class="scan-hint">Positionnez le QR Code devant la cam√©ra</p>
                    </div>

                    <!-- Mode upload image -->
                    <div id="upload-scan" class="scan-mode" style="display: none;">
                        <div class="upload-area">
                            <input type="file" id="qr-file-input" accept="image/*" style="display: none;">
                            <label for="qr-file-input" class="upload-label">
                                <span>üì∑ Cliquez pour s√©lectionner une image</span>
                                <span class="upload-hint">ou glissez-d√©posez une image ici</span>
                            </label>
                            <div id="upload-preview" style="display: none; margin-top: 15px;">
                                <img id="uploaded-image" style="max-width: 100%; max-height: 300px; border-radius: 8px;">
                                <button id="scan-uploaded-btn" class="btn btn-primary" style="margin-top: 10px;">Scanner l'image</button>
                            </div>
                        </div>
                        <p class="scan-hint">T√©l√©chargez une image contenant un QR Code</p>
                    </div>
                </div>

                <!-- Order Details (hidden by default) -->
                <div id="order-details" class="order-details-box" style="display: none;">
                    <h2>D√©tails de la Commande</h2>
                    <div class="order-info">
                        <div class="info-section">
                            <h3>Code de Retrait</h3>
                            <p class="code-display" id="display-code"></p>
                        </div>

                        <div class="info-section">
                            <h3>Informations Client</h3>
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="info-label">Nom complet:</span>
                                    <span id="client-name"></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">T√©l√©phone:</span>
                                    <span id="client-phone"></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Email:</span>
                                    <span id="client-email"></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Date de commande:</span>
                                    <span id="order-date"></span>
                                </div>
                            </div>
                        </div>

                        <div class="info-section">
                            <h3>Articles Command√©s</h3>
                            <table class="items-table">
                                <thead>
                                    <tr>
                                        <th>Produit</th>
                                        <th>Quantit√©</th>
                                        <th>Prix</th>
                                    </tr>
                                </thead>
                                <tbody id="order-items-list">
                                    <!-- Les articles seront charg√©s dynamiquement -->
                                </tbody>
                            </table>
                            <div class="total-info">
                                <p><strong>Total: <span id="order-total-display"></span></strong></p>
                            </div>
                        </div>

                        <div class="info-section">
                            <h3>Validation d'Identit√©</h3>
                            <div class="identity-check">
                                <label>
                                    <input type="checkbox" id="identity-verified">
                                    J'ai v√©rifi√© l'identit√© du client (pi√®ce d'identit√©)
                                </label>
                            </div>
                            <div class="identity-check">
                                <label>
                                    <input type="checkbox" id="product-delivered">
                                    Article(s) remis au client
                                </label>
                            </div>
                        </div>

                        <div class="action-buttons">
                            <button id="validate-btn" class="btn btn-success" disabled>Valider le Retrait</button>
                            <button id="cancel-btn" class="btn btn-secondary">Annuler</button>
                            <button id="print-btn" class="btn btn-info">Imprimer</button>
                        </div>

                        <div id="success-message" class="success-message" style="display: none;">
                            <p>‚úÖ Retrait valid√© avec succ√®s ! Le code a √©t√© archiv√©.</p>
                        </div>
                    </div>
                </div>

                <!-- Error Message -->
                <div id="error-message" class="error-message" style="display: none;">
                    <p>‚ùå Code invalide ou d√©j√† utilis√©. Veuillez v√©rifier le code.</p>
                </div>
            </div>

            <!-- Recent Orders List -->
            <div class="recent-orders">
                <h2>Commandes R√©centes</h2>
                <div id="recent-orders-list" class="orders-list">
                    <!-- Les commandes r√©centes seront charg√©es dynamiquement -->
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>Copyright ¬© 2025 - E-shop S√©curis√©.</p>
        </div>
    </footer>

    <!-- Biblioth√®que pour scanner les QR Codes -->
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script src="script.js"></script>
    <script src="boutique-scan.js"></script>
</body>
</html>

